<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>خريطة مجاز الباب</title>
  <script src="https://cesium.com/downloads/cesiumjs/releases/1.129/Build/Cesium/Cesium.js"></script>
  <link href="https://cesium.com/downloads/cesiumjs/releases/1.129/Build/Cesium/Widgets/widgets.css" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: Arial, sans-serif; }
    #cesiumContainer { width: 100vw; height: 100vh; }
    .cesium-viewer-toolbar,
    .cesium-viewer-animationContainer,
    .cesium-viewer-timelineContainer,
    .cesium-viewer .cesium-credit-logoContainer,
    .cesium-viewer .cesium-credit-textContainer {
      display: none !important;
    }
  </style>
</head>
<body>

<div id="cesiumContainer"></div>

<script>
  // إنشاء العارض
  const viewer = new Cesium.Viewer('cesiumContainer', {
    imageryProvider: new Cesium.ArcGisMapServerImageryProvider({
      url: 'https://services.arcgisonline.com/arcgis/rest/services/World_Imagery/MapServer'
    }),
    terrainProvider: new Cesium.EllipsoidTerrainProvider(),
    sceneMode: Cesium.SceneMode.SCENE3D,
    requestRenderMode: false,
    contextOptions: { preserveDrawingBuffer: true }
  });

  // حدود مجاز الباب التقريبية
  const west = 9.5700;   // أبعد نحو الغرب
const east = 9.6700;   // أبعد نحو الشرق
const south = 36.5700; // أبعد نحو الجنوب
const north = 36.6500; // أبعد نحو الشمال

  // منع الكاميرا من الخروج عن الحدود
  const clampCameraToBounds = () => {
    const camera = viewer.camera;
    const cartographic = Cesium.Cartographic.fromCartesian(camera.positionWC);
    const longitude = Cesium.Math.toDegrees(cartographic.longitude);
    const latitude = Cesium.Math.toDegrees(cartographic.latitude);

    const clampedLongitude = Math.min(Math.max(longitude, west), east);
    const clampedLatitude = Math.min(Math.max(latitude, south), north);

    if (longitude !== clampedLongitude || latitude !== clampedLatitude) {
      const height = cartographic.height;
      const newPosition = Cesium.Cartesian3.fromDegrees(clampedLongitude, clampedLatitude, height);
      camera.position = newPosition;
    }
  };

  viewer.scene.postRender.addEventListener(clampCameraToBounds);

  // تحديد موضع الكاميرا في البداية
  viewer.camera.flyTo({
    destination: Cesium.Cartesian3.fromDegrees(9.6192, 36.6103, 2500),
    orientation: {
      heading: Cesium.Math.toRadians(0),
      pitch: Cesium.Math.toRadians(-30),
      roll: 0.0
    },
    duration: 0
  });
</script>

</body>
</html>
